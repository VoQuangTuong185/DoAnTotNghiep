<p-table
  [value]="orders"
  [tableStyle]="{ 'min-width': '60rem' }"
  [loading]="loading">   
  <ng-template pTemplate="header">
    <tr>
      <th>Mã đơn hàng</th>
      <th>Số sản phẩm</th>
      <th>Thời gian đặt hàng</th>
      <th>Phương thức nhận hàng</th>
      <th>VIP</th>
      <th>Tổng tiền</th>      
      <th style="text-align: center">Thao tác</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-order>
    <tr>
      <td>{{ order.id }}</td>
      <td>{{ order.productCount }}</td>
      <td>{{ order.orderDate | date : "hh:mm:ss a, dd/MM/yyyy" }}</td>
      <td>{{ order.payment }}</td>
      <td>{{ order.discountVIP }}%</td>
      <td>{{ order.totalBill | currency : "VND" }}</td>
      <td style="text-align: center">
        <p-button *ngIf="this.statusOrderCode === this.enumData.statusOrder.wait.code" label="Huỷ" styleClass="p-button-danger"
          icon="pi pi-times" (click)="confirmCancelOrder(order.id)">
        </p-button>
        <p-button label="Chi tiết" icon="pi pi-list" [style]="{ 'margin-left': '10px' }" (click)="openModalOrderDetail(order)">
        </p-button>
        <p-button *ngIf="statusOrderCode === this.enumData.statusOrder.success.code" label="Đánh giá" icon="pi pi-comments" [style]="{ 'margin-left': '10px' }" styleClass="p-button-help" (click)="openFeedback(order)">
      </p-button>
      </td>
    </tr>
  </ng-template>
</p-table>
<form [formGroup]="feedbackForm" (ngSubmit)="submitFeedback()">
  <p-dialog [(visible)]="displayFeedbackPopup" [style]="{width: '450px'}" header="Đánh giá" [modal]="true" styleClass="p-fluid" class="profile">
    <ng-container formArrayName="feedbacks">
      <ng-container *ngFor="let feedback of feedbacks.controls; let i = index">
        <div class="mx-3" [formGroupName]="i">
          <span class="mb-3"><b>{{feedbacks.controls[i].get('ProductName')?.value}}</b></span>      
          <div>
            <mat-radio-group matInput formControlName="Votes" class="mb-3">
              <mat-radio-button value="1" [checked]="feedbacks.controls[i].get('Votes')?.value === 1">1&#9733;</mat-radio-button>
              <mat-radio-button value="2" [checked]="feedbacks.controls[i].get('Votes')?.value === 2">2&#9733;</mat-radio-button>
              <mat-radio-button value="3" [checked]="feedbacks.controls[i].get('Votes')?.value === 3">3&#9733;</mat-radio-button>
              <mat-radio-button value="4" [checked]="feedbacks.controls[i].get('Votes')?.value === 4">4&#9733;</mat-radio-button>
              <mat-radio-button value="5" [checked]="feedbacks.controls[i].get('Votes')?.value === 5">5&#9733;</mat-radio-button>
            </mat-radio-group> 
          </div>
          <mat-form-field class="mt-3 comments">
            <mat-label>Đánh giá</mat-label>
            <textarea matInput formControlName="Comments" type="string" rows="4" cols="60"></textarea>
            <mat-error *ngIf="feedback.get('Comments')?.hasError('maxlength')">
              Số lượng kí tự tối đa là 255!
          </mat-error>  
          </mat-form-field>
        </div>
        <hr style="margin-top: -0.5rem;">
      </ng-container>
    </ng-container>
    <ng-template pTemplate="footer">
        <div class="pt-2">
            <button pButton label="Lưu" class="p-button-rounded p-button-success"></button>    
            <button pButton label="Huỷ" class="p-button-rounded p-button-secondary ml-1" type="button" (click)="hideFeedbackPopup()"></button> 
        </div>
    </ng-template>
  </p-dialog>
</form>
